<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Voice Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        border: "hsl(217.2 32.6% 17.5%)",
                        input: "hsl(217.2 32.6% 17.5%)",
                        ring: "hsl(212.7 26.8% 83.9%)",
                        background: "hsl(222.2 84% 4.9%)",
                        foreground: "hsl(210 40% 98%)",
                        primary: {
                            DEFAULT: "hsl(210 40% 98%)",
                            foreground: "hsl(222.2 84% 4.9%)",
                        },
                        secondary: {
                            DEFAULT: "hsl(217.2 32.6% 17.5%)",
                            foreground: "hsl(210 40% 98%)",
                        },
                        destructive: {
                            DEFAULT: "hsl(0 62.8% 30.6%)",
                            foreground: "hsl(210 40% 98%)",
                        },
                        muted: {
                            DEFAULT: "hsl(217.2 32.6% 17.5%)",
                            foreground: "hsl(215 20.2% 65.1%)",
                        },
                        accent: {
                            DEFAULT: "hsl(217.2 32.6% 17.5%)",
                            foreground: "hsl(210 40% 98%)",
                        },
                        popover: {
                            DEFAULT: "hsl(222.2 84% 4.9%)",
                            foreground: "hsl(210 40% 98%)",
                        },
                        card: {
                            DEFAULT: "hsl(222.2 84% 4.9%)",
                            foreground: "hsl(210 40% 98%)",
                        },
                    },
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background: #000000;
        }
        
        .status-pulse {
            animation: status-pulse 2s ease-in-out infinite;
        }
        
        @keyframes status-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        
        .visualizer-bar {
            transition: height 0.1s ease;
            background: linear-gradient(to top, #3b82f6, #8b5cf6);
        }
        
        .visualizer-container {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 50%, rgba(236, 72, 153, 0.1) 100%);
            border: 1px solid rgba(59, 130, 246, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .btn-primary {
            @apply bg-white text-black hover:bg-gray-100 transition-all duration-200 font-medium transform hover:scale-105 active:scale-95;
        }
        
        .btn-secondary {
            @apply bg-gray-800 text-white hover:bg-gray-700 border border-gray-700 transition-all duration-200 transform hover:scale-105 active:scale-95;
        }
        
        .card {
            @apply bg-gray-900 border border-gray-800 rounded-lg;
        }
        
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-track {
            background: #1f2937;
            border-radius: 3px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 3px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }
        
        .debug-logs {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            line-height: 1.4;
        }
        
        .interactive-element {
            transition: all 0.2s ease-in-out;
        }
        
        .interactive-element:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body class="min-h-screen bg-black text-white antialiased">
    <div class="max-w-7xl mx-auto p-6">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white mb-2">üé§ AI Voice Assistant</h1>
            <p class="text-gray-400">Enhanced GPT-4o Realtime API ‚Ä¢ Studio Quality Audio ‚Ä¢ Real-time Transcription</p>
        </div>

        <!-- Main Content -->
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            <!-- Left Panel: Controls & Status -->
            <div class="lg:col-span-1 space-y-6">
                <!-- Connection Status -->
                <div class="card p-4 interactive-element">
                    <h3 class="text-sm font-medium text-white mb-3">üìä Status</h3>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <span class="text-xs text-gray-400">Connection</span>
                            <div class="flex items-center space-x-2">
                                <div id="connectionStatusIcon" class="w-2 h-2 rounded-full bg-red-500"></div>
                                <span id="connectionStatusText" class="text-xs text-gray-300">Disconnected</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-xs text-gray-400">Microphone</span>
                            <div class="flex items-center space-x-2">
                                <div id="micStatusIcon" class="w-2 h-2 rounded-full bg-gray-500"></div>
                                <span id="micStatusText" class="text-xs text-gray-300">Inactive</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-xs text-gray-400">AI Status</span>
                            <div class="flex items-center space-x-2">
                                <div id="aiStatusIcon" class="w-2 h-2 rounded-full bg-gray-500"></div>
                                <span id="aiStatusText" class="text-xs text-gray-300">Idle</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Controls -->
                <div class="card p-4 interactive-element">
                    <h3 class="text-sm font-medium text-white mb-3">üéÆ Controls</h3>
                    <div class="space-y-3">
                        <button id="connectBtn" class="w-full px-4 py-3 btn-primary rounded-md text-sm font-semibold">
                            üöÄ Connect
                        </button>
                        <button id="micBtn" class="w-full px-4 py-3 btn-secondary rounded-md text-sm font-semibold" disabled>
                            üé§ Start Voice
                        </button>
                        <button id="clearBtn" class="w-full px-4 py-3 btn-secondary rounded-md text-sm font-semibold">
                            üßπ Clear
                        </button>
                    </div>
                </div>

                <!-- Settings -->
                <div class="card p-4 interactive-element">
                    <h3 class="text-sm font-medium text-white mb-3">‚öôÔ∏è Settings</h3>
                    <div class="space-y-3">
                        <div>
                            <label class="block text-xs text-gray-400 mb-1">üé≠ Voice</label>
                            <select id="aiVoice" class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-sm text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200">
                                <option value="alloy">üé™ Alloy - Balanced</option>
                                <option value="echo">üì¢ Echo - Rich</option>
                                <option value="shimmer" selected>‚ú® Shimmer - Human-like</option>
                                <option value="nova">‚≠ê Nova - Bright</option>
                                <option value="sage">üßô‚Äç‚ôÇÔ∏è Sage - Calm</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-xs text-gray-400 mb-1">‚ö° Response Speed</label>
                            <select id="vadEagerness" class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-sm text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200">
                                <option value="low">üêå Slow - Patient</option>
                                <option value="medium">‚öñÔ∏è Medium - Balanced</option>
                                <option value="high" selected>‚ö° Fast - Responsive</option>
                            </select>
                        </div>
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="interruptResponse" checked class="w-4 h-4 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500 transition-all duration-200">
                            <label for="interruptResponse" class="text-xs text-gray-400">üö¶ Allow interruption</label>
                        </div>
                    </div>
                </div>

                <!-- Audio Visualizer -->
                <div class="card p-4 interactive-element">
                    <h3 class="text-sm font-medium text-white mb-3">üéµ Audio Visualizer</h3>
                    <div class="visualizer-container rounded-lg p-4">
                        <div id="visualizer" class="flex justify-center items-end space-x-1 h-20">
                            <!-- Visualizer bars will be generated here -->
                        </div>
                        <div class="text-center mt-2">
                            <span class="text-xs text-gray-400">Real-time Audio Analysis ‚Ä¢ 24kHz PCM16</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel: Chat -->
            <div class="lg:col-span-3">
                <div class="card h-[700px] flex flex-col">
                    <!-- Chat Header -->
                    <div class="p-4 border-b border-gray-800">
                        <div class="flex items-center justify-between">
                            <h2 class="text-lg font-semibold text-white">üí¨ Conversation</h2>
                            <div id="statusDisplay" class="text-sm text-gray-400 px-3 py-1 bg-gray-800 rounded-md">üîÑ Ready to connect</div>
                        </div>
                    </div>

                    <!-- Chat Messages -->
                    <div class="flex-1 p-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 h-full">
                            <!-- User Speech -->
                            <div class="flex flex-col">
                                <div class="flex items-center space-x-2 mb-3">
                                    <div class="w-2 h-2 rounded-full bg-blue-500"></div>
                                    <span class="text-sm font-medium text-white">üë§ You</span>
                                </div>
                                <div id="userTranscript" class="flex-1 p-3 bg-gray-800 rounded-md overflow-y-auto scrollbar-thin">
                                    <div class="text-gray-500 text-sm text-center mt-20">
                                        üé§ Start speaking to see your words here...
                                    </div>
                                </div>
                            </div>

                            <!-- AI Response -->
                            <div class="flex flex-col">
                                <div class="flex items-center space-x-2 mb-3">
                                    <div class="w-2 h-2 rounded-full bg-green-500"></div>
                                    <span class="text-sm font-medium text-white">ü§ñ AI</span>
                                </div>
                                <div id="aiTranscript" class="flex-1 p-3 bg-gray-800 rounded-md overflow-y-auto scrollbar-thin">
                                    <div class="text-gray-500 text-sm text-center mt-20">
                                        ü§ñ AI responses will appear here...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Enhanced Debug Logs -->
                    <div class="border-t border-gray-800">
                        <div class="p-4">
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-sm font-medium text-white">üîç Debug Logs</span>
                                <button onclick="clearLogs()" class="text-xs text-gray-500 hover:text-gray-300 px-2 py-1 bg-gray-800 rounded transition-colors duration-200">üóëÔ∏è Clear</button>
                            </div>
                            <div id="debugLogs" class="h-32 p-3 bg-gray-950 rounded text-xs debug-logs overflow-y-auto scrollbar-thin border border-gray-700">
                                <div class="text-blue-400">üîÑ Ready to connect...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize visualizer bars
        function initializeVisualizer() {
            const visualizer = document.getElementById('visualizer');
            const numBars = 20;
            
            for (let i = 0; i < numBars; i++) {
                const bar = document.createElement('div');
                bar.className = 'visualizer-bar w-1 bg-gradient-to-t from-blue-500 to-purple-500 rounded-sm';
                bar.style.height = '4px';
                visualizer.appendChild(bar);
            }
        }

        // Update visualizer with audio data
        function updateVisualizer(audioData) {
            const bars = document.querySelectorAll('.visualizer-bar');
            if (!audioData || !bars.length) return;
            
            bars.forEach((bar, index) => {
                const dataIndex = Math.floor((index / bars.length) * audioData.length);
                const height = Math.max(4, (audioData[dataIndex] / 255) * 60);
                bar.style.height = `${height}px`;
            });
        }

        // Settings update function
        function updateSettings() {
            if (window.realtimeClient && window.realtimeClient.updateSettings) {
                const settings = {
                    voice: document.getElementById('aiVoice').value,
                    vadEagerness: document.getElementById('vadEagerness').value,
                    interruptResponse: document.getElementById('interruptResponse').checked
                };
                window.realtimeClient.updateSettings(settings);
            }
        }

        // Clear logs function
        function clearLogs() {
            const debugLogs = document.getElementById('debugLogs');
            if (debugLogs) {
                debugLogs.innerHTML = '<div class="text-blue-400">üîÑ Logs cleared...</div>';
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeVisualizer();
            
            // Add event listeners for settings
            ['aiVoice', 'vadEagerness', 'interruptResponse'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', updateSettings);
                }
            });
        });

        // Expose functions globally for the client
        window.updateVisualizer = updateVisualizer;
        window.updateSettings = updateSettings;
        window.clearLogs = clearLogs;
    </script>

    <script src="realtime-webrtc-client.js"></script>
</body>
</html> 